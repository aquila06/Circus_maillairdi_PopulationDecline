# Circus_maillairdi_PopulationDecline
This is a repository aimed at storing the scripts and data of a manuscript entitled "Long-term population monitoring reveals an alarming decline in the endangered endemic Reunion Harrier *Circus maillardi*"   [preprint on bioRxiv](https://www.biorxiv.org/content/10.1101/2025.11.07.687144)


# Folder and file overview

## a *Scripts* folder with 3 R scripts files used to load, format, analyse the data and produce the figures of the asssociated manuscript
*  Script_MS_run_models_v1.r, an R script to format the data, run the models, and generate the figures
*  compute_spatio_temp_trends_gam_vcov.r, which contains  2 home-made functions written to compute mean trend and 95% CI, (adpaated from Wood 2017 and Knape 2016), called by the :
     *  compute_distri which computes temporal variations of an abundance index values based on a mgcv::gam() model, a data.frame containing variables for predictions, a time variable and possibily a grouping factor (such as a pixel index to spatialise predictions on a grid. This fuction return a list of predicted values of abundance for each level of the grouping factor, at the different values specified for the time variable
    * compute_trends which, from the list generated by the above function, compute the trends between a specified values ystart and yend, for the beginning and the end of the period to consider. If a grouping factor has been specified in compute_distri, it must specified in this function.
* ncf_sp_correl2ggplot.r, a function whose aim is to format the outputs of the ncf::spline_correlogram() function for ggplot2

## Use
The *Script_MS_run_models_v1.r* file will read the necessary files, run the different models and create the figures that are included in the manuscript (both in the main text and in supplementary material)

## a Data folder with 3 data files:
* df_pts_full.csv, with semi-colon as separator, a text file containing the following relevant columns:
  * date (character): in a DD/MM/YYYY format (correpsonding to the concatenation of the 3 following columns, day, month and year)
  * survey (integer): the number of the considered survey 1 = 1998-200, 2 = 2009-2010, 3 = 2017-2019
  * lenght (interger):! the duration of observation , correponding to the Effort variable in the manuscript (not log-transformed)
  * ptot (integer): the total number of unique pairs of harriers considered as breeding during the observation session
  * X,Y (numeric): coordinates of thee observation point, with projection EPSG:2975 (RGR92 / UTMzone 40S)
  * long, lat (numeric): coordinates of observation point, with EPSG:4326 coordinate system (WGS84)
  * surveyF (character): the survey column expressed as text
  * id_newF (character): the ID of the observation points, with points sampled during different surveys sharing the same identifier.
  * log_length (numeric): 
* coords_areas.csv, with semi-colon as separator, with 3 columns, allowing to build the limits of the study area (coastlines of la RÃ©union Island) as well as the 2 areas used in the manuscript to compute regional trends (windward and leeward parts of the island):
  * X,Y (numeric): coordinates, with projection EPSG:2975 (RGR92 / UTMzone 40S)
  * Region (integer): with 1 and 2, respectively corresponding to the West and East part of the island
* reu_mnt_tiles_res100m.tif, a raster image wich correpsonds to the reasmpling of the IGN BD alti data set (originally with a 5m. resolution) at a 100m. resolution, with EPSG:2975 projection (RGR92 / UTMzone 40S)



# References
