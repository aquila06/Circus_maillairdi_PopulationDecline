# Circus_maillairdi_PopulationDecline
This is a repository aimed at storing the scripts and data of a manuscript entitled "Long-term population monitoring reveals an alarming decline in the endangered endemic Reunion Harrier Circus maillardi"  



It contains:
* a Scripts folder with the different R scripts used to load, format, analyse the data and produce the figures of the asssociated masnucript
     *  Script_MS_run_models_v1.r, an R script to format the data, run the models, and generate the figures
     *  compute_spatio_temp_trends_gam_vcov.r, which contains  2 home-made functions:
          *  compute_distri which computes temporal variations of an abundance index values based on a mgcv::gam() model, a data.frame containing variables for predictions, a time variable and possibily a grouping factor (such as a pixel index to spatialise predictions on a grid. This fuction return a list of predicted values of abundance for each level of the grouping factor, at the different values specified for the time variable
           * compute_trends which, from the list generated by the above function, compute the trends between a specified values ystart and yend, for the beginning and the end of the period to consider. If a grouping factor has been specified in compute_distri, it must specified in this function.
*  a Data folder with 3 data files:
     * df_pts_full.csv, a text file containing the different variables used in the code. Coordinates are stored in the  X and Y columns, with projection EPSG:2975
     * coords_areas.csv, with semi-colon as separator, with 3 columns, allowing to build the limits of the study area (coastlines of la RÃ©union Island) as well as the 2 areas used in the manuscript to compute regional trends (windward and leeward parts of the island).  
     * reu_mnt_tiles_res100m.tif, a raster image wich correpsonds to the reasmpling of the IGN BD alti data set (originally with a 5m. resolution) at a 100m. resolution, with EPSG:2975 projection
